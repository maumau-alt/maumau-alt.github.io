<!DOCTYPE html>
<meta charset="utf-8">

<!-- ブログ作るのめんどくさいのでhtmlベタ書き -->

<style>
body {
  white-space: pre;
}

.mattya {
  font-size: small;
}

table {
  border-collapse: collapse;
}

.data {
  display: inline-block;
  margin: 0px 0.8em;
  text-align: center;
}

td, th {
  border: 2px solid black;
  padding: 4px 6px;
  text-align: center;
}

.zero {
  background-color: lightskyblue;
}
</style>

<script>
window.addEventListener("DOMContentLoaded", function(){
  Array.from(document.querySelectorAll("td")).forEach(function(cell){
    if (cell.textContent == "0") {
      cell.className = "zero";
    }
  })
})
</script>

<title>オルガルの素早さ・行動順の関係性と抹茶氏(@orugaru_mattya)問題について</title>

オルガルの素早さ・行動順の関係性と抹茶氏(@orugaru_mattya)問題について

<hr><span class="mattya">名指しの前書き： 抹茶氏(<a href=http://twitter.com/orugaru_mattya>@orugaru_mattya</a>)へ。

あなたの粗末な脳から発生するいかなる意見・反論・感想も拒絶します。
死ぬまでコスプレイヤー達の尻を追い続けていて下さいね。
来世ではお猿さんに輪廻転生することを強く推奨します。<hr></span>

<h1>抹茶氏の主張</h1>
ロリ服愛梨には味方全体の素早さを大きく上げる「<mark>スピードスティング</mark>」がある。
パラメータを上昇させる効果はしばしば「バフ」と呼ばれるので、以下もこれに習う。

<table>
  <tr><td>￼<img src="airi_skill.PNG">￼￼￼</td></tr>
</table>

抹茶氏(<a href=http://twitter.com/orugaru_mattya>@orugaru_mattya</a>)が、このバフがバグっていると主張し運営に問い合わせ、
「仕様通りに動いている」という回答を受けて運営が隠蔽しようとしていると言ってキレてた。
彼の主張をまとめるとこう。

「素早さ101でバフ(スキルlv4)をかけると、敵の行動をスキップして2連続で行動できる。
　素早さ119でバフ(スキルlv1)をかけると、敵の行動をスキップできない。
　スキルlv1なら問題なく動作しているがスキルlv4はバグっていて効果がない。」

(そう主張するのは全く問題ない。が、誰の指摘も聞き入れないのでめんどくさいから放置した。
 それから珍妙な理論で周りを罵倒し始め、筆者も「絡んできたバカ」にカウントされたので変なスイッチが入った。)

先に言っておくと、効果範囲が全体であること、スキルレベルが違うことは無関係。
そもそもスキルlvの説明に「ダメージ量UP」としか書かれてないが、お猿さんには文字が読めない。
(まぁたしかに文章と実装が一致しているのかは検証しないと分からないが)

この記事では、この挙動が必ずしもバグとは言えないということを抹茶氏以外のキャプテンに伝えたかった。
てか、運営がわざわざ調査して問題ないって言ってんだから当たり前なんだけどさ。

<h1>ガバガバ検証</h1>
<table>
  <tr><td>￼<img src="rei_skill.PNG">￼￼￼</td></tr>
</table>

うちにはロリ愛梨がいないので、マイコーデ玲の<mark>スピードホーミング</mark>(単体素早さ大バフ)で代用する。
シールで素早さを101と119に調整し、初回行動時にバフをかける。
場所はイベントの超5。(抹茶氏は絶5で回っていたが素早さは変わらないだろう)

<table>
  <tr>
    <td><img src="rei_101_1.PNG"></td>
    <td><img src="rei_101_2.PNG">￼</td>
    <td><img src="rei_101_status.PNG">￼￼</td>
  </tr>
</table>
素早さ101の場合。
バフを打った直後、敵の行動をスキップ出来ている。

<table>
  <tr>
    <td><img src="rei_119_1.PNG"></td>
    <td><img src="rei_119_2.PNG">￼</td>
    <td><img src="rei_119_status.PNG">￼￼</td>
  </tr>
</table>
素早さ119の場合。
バフを打った直後、敵の行動をスキップ出来ていない。

たしかに彼の言う通りの結果になった。
だが玲の初回行動のターン数が違うことに気付いただろうか？
・素早さ101：ターン数2
・素早さ119：ターン数0

素早さ101では敵より素早さが遅く、玲の前に敵が行動してしまうんだ。
<table>
  <tr><td>￼<img src="rei_101_0.PNG">￼￼￼</td></tr>
</table>

玲と敵Bの行動だけを抜き出すとこう。
・素早さ101: 敵、玲、玲
・素早さ119: 玲、敵、玲

<h1>ガバガバ仮説</h1>
オルガルの素早さと行動順がどう関係しているのかを想像してみよう。
FF10のCTB(カウントタイムバトル)が非常によく似ているので、それを元に考える。
ちなみにFF10ではキャラの行動選択によっても行動順が変わるがオルガルは一定なのでもっとシンプルにする。
尚、ここでは乱数は考慮しない。(説明が長くなるし±nなら平均0なので)

ドラクエのように、全員が1ターンに1度ずつ行動するなら単純に素早さ順に行動させればいい。
オルガルはそうではなく、素早ければ他のメンバーの行動を飛ばして連続行動できたりする。
概ね素早さの順に並ぶが、素早さだけでは行動順を決めることができない。

そこで素早さから「待機時間」を計算し、1ずつ減らして0になったキャラから行動できることにする。
素早いキャラほど素早さの数値は高いが、逆に「待機時間」は小さい数値となる。

待機時間の計算式は運営のみ知るところなので、分からない。
とりあえず概ね素早さ順に並べばいいので仮に「300 - 素早さ」と仮定する。
仮なので「そんな単純なわけないだろ」とかそういったツッコミは無意味。

計算が面倒なので、素早さはキリのいい数値に揃えておく。
今回の敵の素早さは101より少し素早い程度だと思うので、105とする。

・玲A: 素早さ100, 待機時間200 (300 - 100)
・玲B: 素早さ120, 待機時間180 (300 - 120)
・敵: 素早さ105, 待機時間195 (300 - 105)

行動順の表も作ってみる。
<table class="data">
  <tr><th>行動</th><th>玲Aの待機時間</th><th>敵の待機時間</th><th>経過時間</th></tr>
  <tr><td>-</td><td>200</td><td>195</td><td>(0)</td></tr>
  <tr><td>敵</td><td>5</td><td>0</td><td>195</td></tr>
  <tr><td>玲A</td><td>0</td><td>190</td><td>200</td></tr>
  <tr><td>敵</td><td>10</td><td>0</td><td>390</td></tr>
  <tr><td>玲A</td><td>0</td><td>185</td><td>400</td></tr>
  <tr><td>敵</td><td>15</td><td>0</td><td>585</td></tr>
  <tr><td>玲A</td><td>0</td><td>180</td><td>600</td></tr>
</table><table class="data">
  <tr><th>行動</th><th>玲Bの待機時間</th><th>敵の待機時間</th><th>経過時間</th></tr>
  <tr><td>-</td><td>180</td><td>195</td><td>(0)</td></tr>
  <tr><td>玲B</td><td>0</td><td>15</td><td>180</td></tr>
  <tr><td>敵</td><td>165</td><td>0</td><td>195</td></tr>
  <tr><td>玲B</td><td>0</td><td>30</td><td>360</td></tr>
  <tr><td>敵</td><td>150</td><td>0</td><td>390</td></tr>
  <tr><td>玲B</td><td>0</td><td>45</td><td>540</td></tr>
  <tr><td>敵</td><td>135</td><td>0</td><td>585</td></tr>
</table>

素早いほうから順番に行動できている。
また、この通りに進めば、少しでも素早さが上回っているキャラは数十ターン後に2連続行動することも分かる。

次はバフを考えてみる。
バフについても謎が多いが、素早さバフ大の場合、素早さに固定値で+20、つまり待機時間が20減る計算と仮定する。
玲の初回行動時にバフをかけることにし、行動順を計算し直す。

<table class="data">
  <tr><th>行動</th><th>玲Aの待機時間</th><th>敵の待機時間</th><th>経過時間</th></tr>
  <tr><td>-</td><td>200</td><td>195</td><td>(0)</td></tr>
  <tr><td>敵</td><td>5</td><td>0</td><td>195</td></tr>
  <tr><td>玲A</td><td>0</td><td>190</td><td>200</td></tr>
  <tr><td>玲A</td><td>0</td><td>10</td><td>380</td></tr>
  <tr><td>敵</td><td>170</td><td>0</td><td>390</td></tr>
  <tr><td>玲A</td><td>0</td><td>25</td><td>560</td></tr>
  <tr><td>敵</td><td>155</td><td>0</td><td>585</td></tr>
</table><table class="data">
  <tr><th>行動</th><th>玲Bの待機時間</th><th>敵の待機時間</th><th>経過時間</th></tr>
  <tr><td>-</td><td>180</td><td>195</td><td>(0)</td></tr>
  <tr><td>玲B</td><td>0</td><td>15</td><td>180</td></tr>
  <tr><td>敵</td><td>145</td><td>0</td><td>195</td></tr>
  <tr><td>玲B</td><td>0</td><td>50</td><td>360</td></tr>
  <tr><td>敵</td><td>110</td><td>0</td><td>390</td></tr>
  <tr><td>玲B</td><td>0</td><td>85</td><td>540</td></tr>
  <tr><td>敵</td><td>95</td><td>0</td><td>585</td></tr>
</table>

玲Aの初回行動後、敵の待機時間は190だが、玲Aはバフによって180になるので敵よりも早く行動できる。
バフをかけた場合、玲Aは行動順が入れ替わるが、玲Bは入れ替わらない。

では玲Bでバフをかけることは無意味なのか？
もちろんそんなことはない。

先ほど「少しでも素早さが上回っているキャラは数十ターン後に2連続行動する」と書いた。
そのタイミングを何ターン程度か早めることができる。
そんな長期戦にはあまりならないが。

この記事の計算式は単純すぎてお話にならないが、似たシステムで動いているはず。
もっと正しい仮説を考える際の参考になればと思う。

この記事書いててまた新たに分かってきたこともあるけど、キリがないのでやめておく。

<hr>

お猿さんにも読まれるかもしれないので何度でも書きますが、この記事で伝えたいのは「絶対にこういう原理で動いている！」ということではありません。
こんな感じの実装ならこの挙動はバグではない、ということです。
この記事を批判しても無意味ですよ。仮説ですし。

コスプレイヤー粘着おじさんこと抹茶先生(<a href=http://twitter.com/orugaru_mattya>@orugaru_mattya</a>)の今後の活躍にご期待ください。

以上

<a href=http://twitter.com/maumau_alt>@maumau_alt</a>
